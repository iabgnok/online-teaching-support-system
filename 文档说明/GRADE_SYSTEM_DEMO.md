# 成绩系统快速演示

## 📋 已完成的工作

### 1. 后端开发 ✅
- 创建了 4 个数据库模型（GradeCategory, GradeItem, StudentGradeScore, StudentFinalGrade）
- 开发了 15 个 API 端点
- 实现了考勤自动计算功能
- 实现了加权平均和排名算法

### 2. 前端开发 ✅
创建了 4 个新页面：

#### 教师端（3个页面）
1. **成绩配置页** - `/teacher/class/:id/grade-config`
   - 管理成绩分类和成绩项
   - 设置权重
   - 公开/隐藏成绩

2. **成绩录入页** - `/teacher/class/:id/grade-item/:itemId`
   - 表格形式批量录入
   - 实时显示百分制
   - 一键保存

3. **成绩统计页** - `/teacher/class/:id/grade-statistics`
   - 统计数据展示
   - 成绩分布图表
   - 排名列表

#### 学生端（1个页面）
4. **我的成绩** - `/my-grades`
   - 查看总评成绩
   - 查看班级排名
   - 查看各分类明细

### 3. 数据库迁移 ✅
- 成功创建 4 个新表
- 所有表结构已就绪

### 4. 路由配置 ✅
- 添加了 4 个新路由
- 更新了导航栏
- 学生端新增"我的成绩"菜单

---

## 🚀 立即开始使用

### 教师使用步骤

1. **登录系统**
   - 使用教师账号登录
   - 进入工作台

2. **选择教学班**
   - 点击某个教学班进入详情
   - 切换到"成绩管理"标签页

3. **配置成绩结构**
   ```
   第一步：点击"成绩配置"按钮
   第二步：添加分类（如：平时30%、期中30%、期末40%）
   第三步：为每个分类添加成绩项
   ```

4. **录入成绩**
   ```
   方式1：点击成绩项的"录入成绩"按钮，批量输入
   方式2：如果是考勤项，点击"计算考勤"自动计算
   ```

5. **计算总评**
   ```
   点击"计算总评成绩"按钮
   系统自动计算加权平均分和班级排名
   ```

6. **公开成绩**
   ```
   切换成绩项的"已公开"开关
   学生即可查看
   ```

### 学生使用步骤

1. **登录系统**
   - 使用学生账号登录

2. **查看成绩**
   ```
   方式1：点击顶部导航栏"我的成绩"
   方式2：选择课程查看该课程成绩
   ```

3. **查看详情**
   - 总评成绩（大号显示）
   - 班级排名和百分位
   - 各分类得分
   - 各成绩项明细

---

## 💡 示例配置

### 配置示例1：简单模式
```
📊 平时成绩 (60%)
   ├─ 📅 考勤 (100分) - 考勤自动
   
📊 期末考试 (40%)
   └─ 📝 期末考试 (100分) - 手动录入
```

### 配置示例2：标准模式
```
📊 平时成绩 (30%)
   ├─ 📅 考勤 (100分) - 考勤自动, 权重40%
   ├─ 📝 作业 (100分) - 手动录入, 权重30%
   └─ 💬 课堂表现 (100分) - 手动录入, 权重30%
   
📊 期中考试 (30%)
   └─ 📝 期中笔试 (100分) - 手动录入, 权重100%
   
📊 期末考试 (40%)
   └─ 📝 期末笔试 (100分) - 手动录入, 权重100%
```

---

## 🎯 核心功能特点

### 1. 灵活的权重系统
- 分类级别权重（如：平时30% + 期中30% + 期末40%）
- 成绩项级别权重（如：考勤40% + 作业30% + 课堂表现30%）
- 两级加权计算，精准控制

### 2. 多种成绩来源
- **手动录入**：适用于考试、课堂表现等
- **关联作业**：自动从作业系统获取（待实现）
- **考勤自动**：自动统计出勤率并计算得分
- **关联考试**：可关联考试系统（待实现）

### 3. 自动排名系统
- 计算总评时自动生成班级排名
- 显示百分位排名（如"前10%"）
- 支持并列排名

### 4. 成绩公开控制
- 每个成绩项独立控制公开状态
- 未公开的成绩，学生不可见
- 方便分步骤发布成绩

### 5. 考勤自动计算
- 自动统计所有考勤记录
- 计算出勤率
- 按出勤率换算成绩

---

## 📊 数据流程

```
成绩配置
   ↓
添加分类（设置权重）
   ↓
添加成绩项（设置类型、权重）
   ↓
录入成绩/计算考勤
   ↓
计算总评（加权平均 + 排名）
   ↓
公开成绩
   ↓
学生查看
```

---

## 🔧 技术实现

### 后端技术栈
- Flask REST API
- SQLAlchemy ORM
- SQL Server 数据库
- JSON 字段存储复杂数据

### 前端技术栈
- Vue 3 Composition API
- Element Plus UI组件
- Vue Router 路由管理
- Axios HTTP 客户端

### 核心算法
1. **加权平均计算**
   ```python
   总评成绩 = Σ(分类得分 × 分类权重)
   分类得分 = Σ(成绩项得分 × 成绩项权重) / 满分
   ```

2. **排名算法**
   ```python
   按总分降序排列
   相同分数并列排名
   百分位 = (排名 / 总人数) × 100
   ```

3. **考勤计算**
   ```python
   出勤率 = 出勤次数 / 总次数
   考勤分 = 出勤率 × 满分
   ```

---

## 📝 API 接口示例

### 获取成绩结构
```javascript
GET /api/v1/grades/class/123/categories

Response:
[
  {
    "id": 1,
    "name": "平时成绩",
    "weight": 30,
    "items": [
      {
        "id": 1,
        "name": "考勤",
        "type": "attendance",
        "weight": 40,
        "max_score": 100
      }
    ]
  }
]
```

### 批量录入成绩
```javascript
POST /api/v1/grades/items/1/scores

Body:
{
  "scores": [
    {"student_id": 1, "score": 95},
    {"student_id": 2, "score": 88}
  ]
}
```

### 计算总评
```javascript
POST /api/v1/grades/class/123/calculate-final

Response:
{
  "total_students": 50,
  "success": 45,
  "failed": 5
}
```

---

## ✨ 页面截图说明

### 教师端 - 成绩配置页
- 顶部：权重总和提醒（必须为100%）
- 左侧：分类列表（展开显示成绩项）
- 右侧：添加/编辑操作
- 底部：计算总评、公开成绩按钮

### 教师端 - 成绩录入页
- 表格形式
- 学号、姓名、得分输入框
- 自动显示百分制
- 备注栏

### 教师端 - 成绩统计页
- 顶部：关键指标卡片（平均分、最高分、最低分、及格率）
- 中部：分数分布图表
- 底部：排名列表

### 学生端 - 我的成绩
- 顶部：课程选择器
- 卡片1：总评成绩（大号显示，含排名）
- 卡片2+：各分类成绩卡片
- 表格：各成绩项明细

---

## 🎉 开始使用

**后端已启动：** http://localhost:5000  
**前端已启动：** http://localhost:5173

**立即体验：**
1. 教师登录 → 进入任意教学班 → 成绩管理 → 成绩配置
2. 学生登录 → 点击顶部导航"我的成绩"

---

**系统已准备就绪，可以开始使用！** 🚀
