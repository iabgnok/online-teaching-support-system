# 在线教学辅助系统 - 功能与 UI 更新指导文档

本手册旨在指导系统下一阶段的功能开发与界面优化。

## 一、 教师端功能增强

### 1. 教学计划及日历化显示
*   **功能描述**：教师可自主安排教学进度，并在日历上进行日程的增删改查。
*   **日程显示逻辑（颜色渐变）**：
    *   **绿色**：剩余时间 > 2周。
    *   **黄色**：剩余时间 1周 - 2周。
    *   **橙色**：剩余时间 < 1周。
    *   **红色**：剩余时间 = 1天。
*   **联动性控制**：增加“一键同步至学生端”开关。开启后，教师的教学计划将作为参考日程更新到学生端的日历中。
*   **视图切换**：提供“日历视图”与“列表视图”，方便教师批量处理全学期的教学条目。

### 2. 在线授课协同模块 (核心功能)
*   **概念**：整合屏幕共享、实时画板与文字互动于一体的协同界面。
*   **核心逻辑**：
    *   **授课开始**：以教学班为单位发起。系统自动发布一则“授课开始通知”公告，学生通过导航栏“上课页面”入口进入。
    *   **协同机制**：
        *   **画板协同**：通过 Flask-SocketIO 实时同步教师端的 Canvas 涂鸦坐标至学生端（使用百分比坐标以适配不同分辨率）。
        *   **媒体流**：利用 WebRTC 进行屏幕共享视频传输。
    *   **课堂管理**：课中支持便捷下发任务和考勤，数据计入原有统计模块。
    *   **课堂总结**：授课结束时，系统自动汇总互动信息生成“课堂笔记”，由教师决定是否发布给学生。

---

## 二、 学生端功能增强

### 1. 任务日历化显示增强
*   **功能描述**：不仅显示教师派发的任务，支持学生添加个人学习计划。
*   **个人/课程任务区分**：采用“卡片样式”区分教师下发任务（学校要求）与个人添加任务（自我提升）。
*   **临期推送通知**：当日程颜色变红（剩余1天）时，系统自动发送临期消息提醒。

### 2. 在线测试增强 (防作弊优化)
*   **功能描述**：在不建立复杂题库的前提下，强化考试类任务的监控。
*   **监测手段**：
    *   **前端监测**：包括切屏检测、页面水印。
    *   **题目优化**：支持题目顺序随机乱序。
    *   **异常记录**：引入“异常行为记录”功能，记录学生离开页面的频率、时长等数据，作为教师评分的参考。

---

## 三、 系统 UI 架构重构

### 1. 导航栏重塑 (参考 Moodle 风格)
*   **布局**：由传统的横向导航改为左侧竖向排列。
*   **交互逻辑**：
    *   **悬浮压缩态**：初始状态仅显示图标，节省横向空间。
    *   **鼠标悬停展开**：当鼠标移动到导航栏组件上时，向右弹出并显示功能文字名称。

### 2. 账号管理与身份展示
*   **位置**：放置在侧边导航栏底部。
*   **样式**：采用“头像 + 身份（教师/学生）”的 SaaS 架构布局。
*   **功能浮层 (Popover)**：点击后弹出包含“个人设置”、“切换身份”、“退出登录”的二级菜单。

---

## 四、 技术实现建议

### 1. 协同画布实现 (SocketIO)
建议使用百分比坐标发送绘制数据，避免分辨率不一致带来的偏移：
```javascript
// 发送端
this.socket.emit('drawing', { x: currentX / canvasWidth, y: currentY / canvasHeight, color: '#ff0000' });
```

### 2. 状态对齐
教师切换屏幕共享或画板内容时，需通过 Socket 向所有学生端广播同步指令，并带上时间戳以应对网络延迟。

### 3. 持久化存储
虽然课堂交互是实时的，但课堂笔记坐标或聊天记录需通过 SQL Server 与 `LessonID` 关联，以便课后回溯。
