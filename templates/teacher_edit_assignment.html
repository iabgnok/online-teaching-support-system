{% from "macros.html" import dashboard_nav, unified_styles, page_header %}
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>{{ title }} - åœ¨çº¿æ•™å­¦æ”¯æŒç³»ç»Ÿ</title>
    {{ unified_styles() }}
    <style>
        .exam-fields { background: #f8f9fa; padding: 15px; margin-top: 10px; border-radius: 8px; border-left: 4px solid #3498db; }
        .exam-fields.hidden { display: none; }
        .required { color: #dc3545; }
    </style>
    <script>
        function initPage() {
            const type = '{{ assignment.type }}';
            const examFields = document.getElementById('exam-fields');
            if (type === 'exam') {
                examFields.classList.remove('hidden');
            } else {
                examFields.classList.add('hidden');
            }
        }
        window.onload = initPage;
    </script>
</head>
<body>
    <div class="container">
        <div class="nav-bar">
            <div class="nav-links">
                <a href="{{ url_for('teacher_class_detail', class_id=assignment.class_id) }}">â† è¿”å›ç­çº§è¯¦æƒ…</a>
            </div>
            <div class="nav-links">
                <a href="{{ url_for('change_password') }}">ğŸ” ä¿®æ”¹å¯†ç </a>
                <a href="{{ url_for('logout') }}" style="color: #dc3545;">ğŸšº é€€å‡ºç™»å½•</a>
            </div>
        </div>
        
        {{ page_header(title, 'æ•™å­¦ç­ï¼š' + teaching_class.class_name) }}

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="content-section">

        <form method="POST">
            <div class="form-group">
                <label for="type">ç±»å‹</label>
                <input type="text" value="{{ 'ä½œä¸š' if assignment.type == 'homework' else 'è€ƒè¯•' }}" disabled style="background: #f0f0f0;">
            </div>

            <div class="form-group">
                <label for="title">æ ‡é¢˜ <span class="required">*</span></label>
                <input type="text" id="title" name="title" value="{{ assignment.title }}" required>
            </div>

            <div class="form-group">
                <label for="description">è¯´æ˜</label>
                <textarea id="description" name="description">{{ assignment.description or '' }}</textarea>
            </div>

            <div class="form-group">
                <label for="total_score">æ€»åˆ† <span class="required">*</span></label>
                <input type="number" id="total_score" name="total_score" value="{{ assignment.total_score }}" min="0" step="0.01" required>
            </div>

            <div class="form-group">
                <label for="deadline">æˆªæ­¢æ—¶é—´ <span class="required">*</span></label>
                <input type="datetime-local" id="deadline" name="deadline" value="{{ assignment.deadline.strftime('%Y-%m-%dT%H:%M') }}" required>
            </div>

            <div id="exam-fields" class="exam-fields{% if assignment.type != 'exam' %} hidden{% endif %}">
                <h3>è€ƒè¯•ç‰¹æœ‰è®¾ç½®</h3>
                <div class="form-group">
                    <label for="start_time">è€ƒè¯•å¼€å§‹æ—¶é—´</label>
                    <input type="datetime-local" id="start_time" name="start_time" value="{% if assignment.start_time %}{{ assignment.start_time.strftime('%Y-%m-%dT%H:%M') }}{% endif %}">
                </div>

                <div class="form-group">
                    <label for="duration">è€ƒè¯•æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰</label>
                    <input type="number" id="duration" name="duration" value="{{ assignment.duration or '' }}" min="1">
                </div>
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-primary">âœ“ ä¿å­˜ä¿®æ”¹</button>
                <a href="{{ url_for('teacher_class_detail', class_id=assignment.class_id) }}" class="btn btn-secondary">å–æ¶ˆ</a>
            </div>
        </form>
    </div>
</body>
</html>
